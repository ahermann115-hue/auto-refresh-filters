name: Weekly Filter Update

on:
  schedule:
    - cron: '0 3 * * 0'  # –í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 3:00 UTC
  workflow_dispatch:      # –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

jobs:
  update-filters:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        
      - name: Make script executable
        run: chmod +x update.sh
        
      - name: Run update script
        run: ./update.sh
        
      - name: Commit and push changes
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"
          
          # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
          if git status --porcelain | grep -q "blacklist.txt\|whitelist.txt"; then
            git add blacklist.txt whitelist.txt
            git commit -m "ü§ñ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ $(date +'%Y-%m-%d')"
            git push origin main
            echo "‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—É—à–µ–Ω—ã"
          else
            echo "‚ö†Ô∏è –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π"
          fi
